<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-dev docs-doc-id-Java/JDBC">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">JDBC | levana</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://levanaya.github.io/levana/dev/Java/JDBC"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-dev-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-dev-current"><meta data-rh="true" property="og:title" content="JDBC | levana"><meta data-rh="true" name="description" content="1. JDBC概述"><meta data-rh="true" property="og:description" content="1. JDBC概述"><link data-rh="true" rel="icon" href="/levana/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://levanaya.github.io/levana/dev/Java/JDBC"><link data-rh="true" rel="alternate" href="https://levanaya.github.io/levana/dev/Java/JDBC" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://levanaya.github.io/levana/dev/Java/JDBC" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/levana/blog/rss.xml" title="levana RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/levana/blog/atom.xml" title="levana Atom Feed"><link rel="stylesheet" href="/levana/assets/css/styles.02346bc7.css">
<link rel="preload" href="/levana/assets/js/runtime~main.2185223f.js" as="script">
<link rel="preload" href="/levana/assets/js/main.6594e99b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/levana/"><b class="navbar__title text--truncate">📚 Levana&#x27;s life</b></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"></div><a class="navbar__item navbar__link" href="/levana/interview">👨‍💻 面试</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">👨🏻‍🎓 学习</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/levana/dev">程序语言</a></li></ul></div><a href="https://github.com/levanaya/levana" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/levana/dev/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/levana/dev/category/javascript">Javascript</a><button aria-label="打开/收起侧边栏菜单「Javascript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/levana/dev/category/vue">Vue</a><button aria-label="打开/收起侧边栏菜单「Vue」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/levana/dev/category/vue-1">Vue</a><button aria-label="打开/收起侧边栏菜单「Vue」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/levana/dev/category/react">React</a><button aria-label="打开/收起侧边栏菜单「React」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/levana/dev/category/java">Java</a><button aria-label="打开/收起侧边栏菜单「Java」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/JavaSE 基础">JavaSE 基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/levana/dev/Java/JDBC">JDBC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/Maven&amp;MyBatis">Maven&amp;MyBatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/HTTP&amp;Tomcat&amp;Servlet">HTTP&amp;Tomcat&amp;Servlet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/Request&amp;Response">Request&amp;Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/JSP&amp;会话技术">JSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/levana/dev/Java/Filter&amp;Listener&amp;Ajax">Filter&amp;Listener&amp;Ajax</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/levana/dev/category/java框架">Java框架</a><button aria-label="打开/收起侧边栏菜单「Java框架」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/levana/dev/category/入门">Git</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>JDBC</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-jdbc概述">1. JDBC概述<a class="hash-link" href="#1-jdbc概述" title="标题的直接链接">​</a></h2><p>在开发中我们使用的是java语言，那么势必要通过java语言操作数据库中的数据。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11--jdbc概念">1.1  JDBC概念<a class="hash-link" href="#11--jdbc概念" title="标题的直接链接">​</a></h3><p>JDBC   就是使用Java语言操作关系型数据库的一套API</p><p>全称：( Java DataBase Connectivity ) Java 数据库连接</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102140221.png" alt="image-20230102135122056" class="img_ev3q"></p><p>我们开发的同一套Java代码是无法操作不同的关系型数据库，因为每一个关系型数据库的底层实现细节都不一样。如果这样，问题就很大了，在公司中可以在开发阶段使用的是MySQL数据库，而上线时公司最终选用oracle数据库，我们就需要对代码进行大批量修改，这显然并不是我们想看到的。我们要做到的是同一套Java代码操作不同的关系型数据库，而此时sun公司就指定了一套标准接口（JDBC），JDBC中定义了所有操作关系型数据库的规则。众所周知接口是无法直接使用的，我们需要使用接口的实现类，而这套实现类（称之为：驱动）就由各自的数据库厂商给出。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12--jdbc本质">1.2  JDBC本质<a class="hash-link" href="#12--jdbc本质" title="标题的直接链接">​</a></h3><ul><li>官方（sun公司）定义的一套操作所有关系型数据库的规则，即接口</li><li>各个数据库厂商去实现这套接口，提供数据库驱动jar包</li><li>我们可以使用这套接口（JDBC）编程，真正执行的代码是驱动jar包中的实现类</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13--jdbc好处">1.3  JDBC好处<a class="hash-link" href="#13--jdbc好处" title="标题的直接链接">​</a></h3><ul><li>各数据库厂商使用相同的接口，Java代码不需要针对不同数据库分别开发</li><li>可随时替换底层数据库，访问数据库的Java代码基本不变</li></ul><p>以后编写操作数据库的代码只需要面向JDBC（接口），操作哪儿个关系型数据库就需要导入该数据库的驱动包，如需要操作MySQL数据库，就需要再项目中导入MySQL数据库的驱动包。如下图就是MySQL驱动包</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152553.png" alt="image-20230102152553236" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-jdbc快速入门">2. JDBC快速入门<a class="hash-link" href="#2-jdbc快速入门" title="标题的直接链接">​</a></h2><p>先来看看通过Java操作数据库的流程</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152803.png" alt="image-20230102152803629" class="img_ev3q"></p><p>第一步：编写Java代码</p><p>第二步：Java代码将SQL发送到MySQL服务端</p><p>第三步：MySQL服务端接收到SQL语句并执行该SQL语句</p><p>第四步：将SQL语句执行的结果返回给Java代码</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="21--编写代码步骤">2.1  编写代码步骤<a class="hash-link" href="#21--编写代码步骤" title="标题的直接链接">​</a></h3><ul><li><p>创建工程，导入驱动jar包</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152833.png" alt="image-20230102152833333" class="img_ev3q"></p></li><li><p>注册驱动</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;com.mysql.jdbc.Driver&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>获取连接</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connection conn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DriverManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Java代码需要发送SQL给MySQL服务端，就需要先建立连接</p></li><li><p>定义SQL语句</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String </span><span class="token keyword" style="color:#00009f">sql</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">  “</span><span class="token keyword" style="color:#00009f">update</span><span class="token plain">…” </span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>获取执行SQL对象</p><p>执行SQL语句需要SQL执行对象，而这个执行对象就是Statement对象</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Statement stmt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">createStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>执行SQL</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">sql</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>处理返回结果</p></li><li><p>释放资源</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="22--具体操作">2.2  具体操作<a class="hash-link" href="#22--具体操作" title="标题的直接链接">​</a></h3><ul><li>创建新的空的项目</li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152900.png" alt="image-20230102152900129" class="img_ev3q"></p><ul><li>定义项目的名称，并指定位置</li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152915.png" alt="image-20230102152915084" class="img_ev3q"></p><ul><li>对项目进行设置，JDK版本、编译版本</li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102152927.png" alt="image-20230102152927247" class="img_ev3q"></p><ul><li>创建模块，指定模块的名称及位置</li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102153010.png" class="img_ev3q"></p><ul><li><p>导入驱动包</p><p>将mysql的驱动包放在模块下的lib目录（随意命名）下，并将该jar包添加为库文件</p></li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102153100.png" alt="image-20230102153059922" class="img_ev3q"></p><ul><li>在添加为库文件的时候，有如下三个选项<ul><li>Global Library  ： 全局有效</li><li>Project Library :   项目有效</li><li>Module Library ： 模块有效</li></ul></li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102153513.png" alt="image-20230102153512989" class="img_ev3q"></p><ul><li>在src下创建类</li></ul><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102153522.png" alt="image-20230102153522621" class="img_ev3q"></p><ul><li>编写代码如下</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * JDBC快速入门</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class JDBCDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //1. 注册驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //2. 获取连接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String url = &quot;jdbc:mysql://127.0.0.1:3306/db1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //3. 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sql = &quot;update account set money = 2000 where id = 1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //4. 获取执行sql的对象 Statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //5. 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int count = stmt.executeUpdate(sql);//受影响的行数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //6. 处理结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3jdbc-api详解">3，JDBC API详解<a class="hash-link" href="#3jdbc-api详解" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="31--drivermanager">3.1  DriverManager<a class="hash-link" href="#31--drivermanager" title="标题的直接链接">​</a></h3><p>DriverManager（驱动管理类）作用：</p><ul><li><p>注册驱动</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102170437.png" alt="image-20230102170437773" class="img_ev3q"></p><p>registerDriver方法是用于注册驱动的，但是之前做的案例并不是这样写的。而是如下实现</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;com.mysql.jdbc.Driver&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们查询MySQL提供的Driver类，看它是如何实现的，源码如下：</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102170549.png" alt="image-20230102170549456" class="img_ev3q"></p><p>在该类中的静态代码块中已经执行了 <code>DriverManager</code> 对象的 <code>registerDriver()</code> 方法进行驱动的注册了，那么我们只需要加载 <code>Driver</code> 类，该静态代码块就会执行。而 <code>Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</code> 就可以加载 <code>Driver</code> 类。</p><blockquote><p>==提示：==</p><ul><li>MySQL 5之后的驱动包，可以省略注册驱动的步骤</li><li>自动加载jar包中META-INF/services/java.sql.Driver文件中的驱动类</li></ul></blockquote></li><li><p>获取数据库连接</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102170559.png" alt="image-20230102170559465" class="img_ev3q"></p><p>参数说明：</p><ul><li><p>url ： 连接路径</p><blockquote><p>语法：jdbc:mysql://ip地址(域名):端口号/数据库名称?参数键值对1&amp;参数键值对2…</p><p>示例：jdbc:mysql://127.0.0.1:3306/db1</p><p>==细节：==</p><ul><li><p>如果连接的是本机mysql服务器，并且mysql服务默认端口是3306，则url可以简写为：jdbc:mysql:///数据库名称?参数键值对</p></li><li><p>配置 useSSL=false 参数，禁用安全连接方式，解决警告提示</p></li></ul></blockquote></li><li><p>user ：用户名</p></li><li><p>poassword ：密码</p></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="32--connection">3.2  Connection<a class="hash-link" href="#32--connection" title="标题的直接链接">​</a></h3><p>Connection（数据库连接对象）作用：</p><ul><li>获取执行 SQL 的对象</li><li>管理事务</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="321--获取执行对象">3.2.1  获取执行对象<a class="hash-link" href="#321--获取执行对象" title="标题的直接链接">​</a></h4><ul><li><p>普通执行SQL对象</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Statement createStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>预编译SQL的执行SQL对象：防止SQL注入</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PreparedStatement  prepareStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">sql</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过这种方式获取的 <code>PreparedStatement</code> SQL语句执行对象，它可以防止SQL注入。</p></li><li><p>执行存储过程的对象</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CallableStatement prepareCall</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">sql</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过这种方式获取的 <code>CallableStatement</code> 执行对象是用来执行存储过程的，而存储过程在MySQL中不常用。</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="322--事务管理">3.2.2  事务管理<a class="hash-link" href="#322--事务管理" title="标题的直接链接">​</a></h4><p>先回顾一下MySQL事务管理的操作：</p><ul><li>开启事务 ： BEGIN; 或者 START TRANSACTION;</li><li>提交事务 ： COMMIT;</li><li>回滚事务 ： ROLLBACK;</li></ul><blockquote><p>MySQL默认是自动提交事务</p></blockquote><p>接下来学习JDBC事务管理的方法。</p><p>Connection几口中定义了3个对应的方法：</p><ul><li><p>开启事务</p><p>参与autoCommit 表示是否自动提交事务，true表示自动提交事务，false表示手动提交事务。而开启事务需要将该参数设为为false。</p></li><li><p>提交事务</p></li><li><p>回滚事务</p></li></ul><p>具体代码实现如下：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * JDBC API 详解：Connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> class JDBCDemo3_Connection {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> static void main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//1. 注册驱动</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jdbc:mysql:///db1?useSSL=false&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1234&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Connection conn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DriverManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//3. 定义sql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sql1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;update account set money = 3000 where id = 1&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sql2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;update account set money = 3000 where id = 2&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//4. 获取执行sql的对象 Statement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Statement stmt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">createStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ============开启事务==========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">setAutoCommit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//5. 执行sql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> count1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sql1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">//受影响的行数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//6. 处理结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//5. 执行sql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> count2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sql2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">//受影响的行数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//6. 处理结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ============提交事务==========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//程序运行到此处，说明没有出现任何问题，则需求提交事务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Exception e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ============回滚事务==========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//程序在出现异常时会执行到这个地方，此时就需要回滚事务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">rollback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">printStackTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//7. 释放资源</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="33--statement">3.3  Statement<a class="hash-link" href="#33--statement" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="331--概述">3.3.1  概述<a class="hash-link" href="#331--概述" title="标题的直接链接">​</a></h4><p>Statement对象的作用就是用来执行SQL语句。而针对不同类型的SQL语句使用的方法也不一样。</p><ul><li><p>执行DDL、DML语句</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102203400.png" alt="image-20230102203400622" class="img_ev3q"></p></li><li><p>执行DQL语句</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102203408.png" alt="image-20230102203408583" class="img_ev3q"></p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="332--代码实现">3.3.2  代码实现<a class="hash-link" href="#332--代码实现" title="标题的直接链接">​</a></h4><ul><li><p>执行DML语句</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 执行DML语句</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testDML() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //1. 注册驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //3. 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;update account set money = 3000 where id = 1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //4. 获取执行sql的对象 Statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //5. 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int count = stmt.executeUpdate(sql);//执行完DML语句，受影响的行数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //6. 处理结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //System.out.println(count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(count &gt; 0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;修改成功~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;修改失败~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>执行DDL语句</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 执行DDL语句</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testDDL() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //1. 注册驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //3. 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;drop database db2&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //4. 获取执行sql的对象 Statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //5. 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int count = stmt.executeUpdate(sql);//执行完DDL语句，可能是0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //6. 处理结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>注意：</p><ul><li>以后开发很少使用java代码操作DDL语句</li></ul></blockquote></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="34--resultset">3.4  ResultSet<a class="hash-link" href="#34--resultset" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="341--概述">3.4.1  概述<a class="hash-link" href="#341--概述" title="标题的直接链接">​</a></h4><p>ResultSet（结果集对象）作用：</p><ul><li>==封装了SQL查询语句的结果。==</li></ul><p>而执行了DQL语句后就会返回该对象，对应执行DQL语句的方法如下：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ResultSet  executeQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">sql</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">：执行DQL 语句，返回 ResultSet 对象</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>那么我们就需要从 <code>ResultSet</code> 对象中获取我们想要的数据。<code>ResultSet</code> 对象提供了操作查询结果数据的方法，如下：</p><blockquote><p>boolean  next()</p><ul><li>将光标从当前位置向前移动一行 </li><li>判断当前行是否为有效行</li></ul><p>方法返回值说明：</p><ul><li>true  ： 有效航，当前行有数据</li><li>false ： 无效行，当前行没有数据</li></ul></blockquote><blockquote><p>xxx  getXxx(参数)：获取数据</p><ul><li>xxx : 数据类型；如： int getInt(参数) ；String getString(参数)</li><li>参数<ul><li>int类型的参数：列的编号，从1开始</li><li>String类型的参数： 列的名称 </li></ul></li></ul></blockquote><p>如下图为执行SQL语句后的结果</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214457.png" alt="image-20230102214457117" class="img_ev3q"></p><p>一开始光标指定于第一行前，如图所示红色箭头指向于表头行。当我们调用了 <code>next()</code> 方法后，光标就下移到第一行数据，并且方法返回true，此时就可以通过 <code>getInt(&quot;id&quot;)</code> 获取当前行id字段的值，也可以通过 <code>getString(&quot;name&quot;)</code> 获取当前行name字段的值。如果想获取下一行的数据，继续调用 <code>next()</code>  方法，以此类推。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="342--代码实现">3.4.2  代码实现<a class="hash-link" href="#342--代码实现" title="标题的直接链接">​</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 执行DQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testResultSet() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //1. 注册驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //3. 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;select * from account&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //4. 获取statement对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //5. 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResultSet rs = stmt.executeQuery(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //6. 处理结果， 遍历rs中的所有数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* // 6.1 光标向下移动一行，并且判断当前行是否有数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //6.2 获取数据  getXxx()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int id = rs.getInt(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String name = rs.getString(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            double money = rs.getDouble(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(money);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;--------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 6.1 光标向下移动一行，并且判断当前行是否有数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //6.2 获取数据  getXxx()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int id = rs.getInt(&quot;id&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String name = rs.getString(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        double money = rs.getDouble(&quot;money&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(money);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;--------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="35--案例">3.5  案例<a class="hash-link" href="#35--案例" title="标题的直接链接">​</a></h3><ul><li><p>需求：查询account账户表数据，封装为Account对象中，并且存储到ArrayList集合中</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102204428.png" alt="image-20230102204428480" class="img_ev3q"></p></li><li><p>代码实现</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 查询account账户表数据，封装为Account对象中，并且存储到ArrayList集合中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 1. 定义实体类Account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 2. 查询数据，封装到Account对象中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * 3. 将Account对象存入ArrayList集合中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testResultSet2() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //1. 注册驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //3. 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;select * from account&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //4. 获取statement对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //5. 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResultSet rs = stmt.executeQuery(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 创建集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;Account&gt; list = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 6.1 光标向下移动一行，并且判断当前行是否有数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Account account = new Account();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //6.2 获取数据  getXxx()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int id = rs.getInt(&quot;id&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String name = rs.getString(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        double money = rs.getDouble(&quot;money&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //赋值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        account.setId(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        account.setName(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        account.setMoney(money);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 存入集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        list.add(account);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(list);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="36--preparedstatement">3.6  PreparedStatement<a class="hash-link" href="#36--preparedstatement" title="标题的直接链接">​</a></h3><blockquote><p>PreparedStatement作用：</p><ul><li>预编译SQL语句并执行：预防SQL注入问题</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="361--sql注入">3.6.1  SQL注入<a class="hash-link" href="#361--sql注入" title="标题的直接链接">​</a></h4><blockquote><p>SQL注入是通过操作输入来修改事先定义好的SQL语句，用以达到执行代码对服务器进行攻击的方法。</p></blockquote><p>在今天资料下的 <code>day03-JDBC\资料\2. sql注入演示</code> 中修改 <code>application.properties</code> 文件中的用户名和密码，文件内容如下：</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.url=jdbc:mysql://localhost:3306/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.username=root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.password=1234</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在MySQL中创建名为 <code>test</code> 的数据库</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在命令提示符中运行今天资料下的 <code>day03-JDBC\资料\2. sql注入演示\sql.jar</code> 这个jar包。</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214311.png" alt="image-20230102214311057" class="img_ev3q"> </p><p>此时我们就能在数据库中看到user表</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214314.png" alt="image-20230102214314299" class="img_ev3q"></p><p>接下来在浏览器的地址栏输入 <code>localhost:8080/login.html</code> 就能看到如下页面</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214316.png" alt="image-20230102214316838" class="img_ev3q"></p><p>我们就可以在如上图中输入用户名和密码进行登陆。用户名和密码输入正确就登陆成功，跳转到首页。用户名和密码输入错误则给出错误提示，如下图</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214539.png" alt="image-20230102214539150" class="img_ev3q"></p><p>但是我可以通过输入一些特殊的字符登陆到首页。</p><p>用户名随意写，密码写成 <code>&#x27; or &#x27;1&#x27; =&#x27;1</code></p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214319.png" alt="image-20230102214319700" class="img_ev3q"></p><p>这就是SQL注入漏洞，也是很危险的。当然现在市面上的系统都不会存在这种问题了，所以大家也不要尝试用这种方式去试其他的系统。</p><p>那么该如何解决呢？这里就可以将SQL执行对象 <code>Statement</code> 换成 <code>PreparedStatement</code> 对象。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="362--代码模拟sql注入问题">3.6.2  代码模拟SQL注入问题<a class="hash-link" href="#362--代码模拟sql注入问题" title="标题的直接链接">​</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testLogin() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 接收用户输入 用户名和密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String name = &quot;sjdljfld&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String pwd = &quot;&#x27; or &#x27;1&#x27; = &#x27;1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;select * from tb_user where username = &#x27;&quot;+name+&quot;&#x27; and password = &#x27;&quot;+pwd+&quot;&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 获取stmt对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Statement stmt = conn.createStatement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResultSet rs = stmt.executeQuery(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 判断登录是否成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录成功~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录失败~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面代码是将用户名和密码拼接到sql语句中，拼接后的sql语句如下</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tb_user </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;sjdljfld&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token operator" style="color:#393A34">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>从上面语句可以看出条件 <code>username = &#x27;sjdljfld&#x27; and password = &#x27;&#x27;</code> 不管是否满足，而 <code>or</code> 后面的 <code>&#x27;1&#x27; = &#x27;1&#x27;</code> 是始终满足的，最终条件是成立的，就可以正常的进行登陆了。</p><p>接下来我们来学习PreparedStatement对象.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="363--preparedstatement概述">3.6.3  PreparedStatement概述<a class="hash-link" href="#363--preparedstatement概述" title="标题的直接链接">​</a></h4><blockquote><p>PreparedStatement作用：</p><ul><li>预编译SQL语句并执行：预防SQL注入问题</li></ul></blockquote><ul><li><p>获取 PreparedStatement 对象</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SQL语句中的参数值，使用？占位符替代</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String sql = &quot;select * from user where username = ? and password = ?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 通过Connection对象获取，并传入对应的sql语句</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PreparedStatement pstmt = conn.prepareStatement(sql);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>设置参数值</p><p>上面的sql语句中参数使用 ? 进行占位，在之前之前肯定要设置这些 ?  的值。</p><blockquote><p>PreparedStatement对象：setXxx(参数1，参数2)：给 ? 赋值</p><ul><li><p>Xxx：数据类型 ； 如 setInt (参数1，参数2)</p></li><li><p>参数：</p><ul><li><p>参数1： ？的位置编号，从1 开始</p></li><li><p>参数2： ？的值</p></li></ul></li></ul></blockquote></li><li><p>执行SQL语句</p><blockquote><p>executeUpdate();  执行DDL语句和DML语句</p><p>executeQuery();  执行DQL语句</p><p>==注意：==</p><ul><li>调用这两个方法时不需要传递SQL语句，因为获取SQL语句执行对象时已经对SQL语句进行预编译了。</li></ul></blockquote></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="364--使用preparedstatement改进">3.6.4  使用PreparedStatement改进<a class="hash-link" href="#364--使用preparedstatement改进" title="标题的直接链接">​</a></h4><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testPreparedStatement() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 接收用户输入 用户名和密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String name = &quot;zhangsan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String pwd = &quot;&#x27; or &#x27;1&#x27; = &#x27;1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;select * from tb_user where username = ? and password = ?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 获取pstmt对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PreparedStatement pstmt = conn.prepareStatement(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 设置？的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(1,name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(2,pwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResultSet rs = pstmt.executeQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 判断登录是否成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录成功~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录失败~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行上面语句就可以发现不会出现SQL注入漏洞问题了。那么PreparedStatement又是如何解决的呢？它是将特殊字符进行了转义，转义的SQL如下：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tb_user </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;sjdljfld&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\&#x27;or \&#x27;1\&#x27; = \&#x27;1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="365--preparedstatement原理">3.6.5  PreparedStatement原理<a class="hash-link" href="#365--preparedstatement原理" title="标题的直接链接">​</a></h4><blockquote><p>PreparedStatement 好处：</p><ul><li>预编译SQL，性能更高</li><li>防止SQL注入：==将敏感字符进行转义==</li></ul></blockquote><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214339.png" alt="image-20230102214339120" class="img_ev3q"></p><p>Java代码操作数据库流程如图所示：</p><ul><li><p>将sql语句发送到MySQL服务器端</p></li><li><p>MySQL服务端会对sql语句进行如下操作</p><ul><li><p>检查SQL语句</p><p>检查SQL语句的语法是否正确。</p></li><li><p>编译SQL语句。将SQL语句编译成可执行的函数。</p><p>检查SQL和编译SQL花费的时间比执行SQL的时间还要长。如果我们只是重新设置参数，那么检查SQL语句和编译SQL语句将不需要重复执行。这样就提高了性能。</p></li><li><p>执行SQL语句</p></li></ul></li></ul><p>接下来我们通过查询日志来看一下原理。</p><ul><li><p>开启预编译功能</p><p>在代码中编写url时需要加上以下参数。而我们之前根本就没有开启预编译功能，只是解决了SQL注入漏洞。</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">useServerPrepStmts</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>配置MySQL执行日志（重启mysql服务后生效）</p><p>在mysql配置文件（my.ini）中添加如下配置</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">log-output=FILE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">general-log=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">general_log_file=&quot;D:\mysql.log&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slow-query-log=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slow_query_log_file=&quot;D:\mysql_slow.log&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long_query_time=2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>java测试代码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   * PreparedStatement原理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void testPreparedStatement2() throws  Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //2. 获取连接：如果连接的是本机mysql并且端口是默认的 3306 可以简化书写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // useServerPrepStmts=true 参数开启预编译功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String url = &quot;jdbc:mysql:///db1?useSSL=false&amp;useServerPrepStmts=true&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String username = &quot;root&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String password = &quot;1234&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Connection conn = DriverManager.getConnection(url, username, password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 接收用户输入 用户名和密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String name = &quot;zhangsan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String pwd = &quot;&#x27; or &#x27;1&#x27; = &#x27;1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 定义sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String sql = &quot;select * from tb_user where username = ? and password = ?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 获取pstmt对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PreparedStatement pstmt = conn.prepareStatement(sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Thread.sleep(10000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 设置？的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(1,name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(2,pwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResultSet rs = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs = pstmt.executeQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 设置？的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(1,&quot;aaa&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.setString(2,&quot;bbb&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 执行sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs = pstmt.executeQuery();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 判断登录是否成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(rs.next()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录成功~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;登录失败~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //7. 释放资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rs.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pstmt.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conn.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><ul><li><p>执行SQL语句，查看 <code>D:\mysql.log</code> 日志如下:</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102214344.png" alt="image-20230102214344089" class="img_ev3q"></p><p>上图中第三行中的 <code>Prepare</code> 是对SQL语句进行预编译。第四行和第五行是执行了两次SQL语句，而第二次执行前并没有对SQL进行预编译。</p></li></ul><blockquote><p>==小结：==</p><ul><li>在获取PreparedStatement对象时，将sql语句发送给mysql服务器进行检查，编译（这些步骤很耗时）</li><li>执行时就不用再进行这些步骤了，速度更快</li><li>如果sql模板一样，则只需要进行一次检查、编译</li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4数据库连接池">4，数据库连接池<a class="hash-link" href="#4数据库连接池" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41--数据库连接池简介">4.1  数据库连接池简介<a class="hash-link" href="#41--数据库连接池简介" title="标题的直接链接">​</a></h3><blockquote><ul><li><p>数据库连接池是个容器，负责分配、管理数据库连接(Connection)</p></li><li><p>它允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个；</p></li><li><p>释放空闲时间超过最大空闲时间的数据库连接来避免因为没有释放数据库连接而引起的数据库连接遗漏</p></li><li><p>好处</p><ul><li>资源重用</li><li>提升系统响应速度</li><li>避免数据库连接遗漏</li></ul></li></ul></blockquote><p>之前我们代码中使用连接是没有使用都创建一个Connection对象，使用完毕就会将其销毁。这样重复创建销毁的过程是特别耗费计算机的性能的及消耗时间的。</p><p>而数据库使用了数据库连接池后，就能达到Connection对象的复用，如下图</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102231251.png" alt="image-20230102231251683" class="img_ev3q"></p><p>连接池是在一开始就创建好了一些连接（Connection）对象存储起来。用户需要连接数据库时，不需要自己创建连接，而只需要从连接池中获取一个连接进行使用，使用完毕后再将连接对象归还给连接池；这样就可以起到资源重用，也节省了频繁创建连接销毁连接所花费的时间，从而提升了系统响应的速度。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="42--数据库连接池实现">4.2  数据库连接池实现<a class="hash-link" href="#42--数据库连接池实现" title="标题的直接链接">​</a></h3><ul><li><p>标准接口：==DataSource==</p><p>官方(SUN) 提供的数据库连接池标准接口，由第三方组织实现此接口。该接口提供了获取连接的功能：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Connection getConnection()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>那么以后就不需要通过 <code>DriverManager</code> 对象获取 <code>Connection</code> 对象，而是通过连接池（DataSource）获取 <code>Connection</code> 对象。</p></li><li><p>常见的数据库连接池</p><ul><li>DBCP</li><li>C3P0</li><li>Druid</li></ul><p>我们现在使用更多的是Druid，它的性能比其他两个会好一些。</p></li><li><p>Druid（德鲁伊）</p><ul><li><p>Druid连接池是阿里巴巴开源的数据库连接池项目 </p></li><li><p>功能强大，性能优秀，是Java语言最好的数据库连接池之一</p></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="43--driud使用">4.3  Driud使用<a class="hash-link" href="#43--driud使用" title="标题的直接链接">​</a></h3><blockquote><ul><li>导入jar包 druid-1.1.12.jar</li><li>定义配置文件</li><li>加载配置文件</li><li>获取数据库连接池对象</li><li>获取连接</li></ul></blockquote><p>现在通过代码实现，首先需要先将druid的jar包放到项目下的lib下并添加为库文件</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102231345.png" alt="image-20230102231345262" class="img_ev3q"></p><p>项目结构如下：</p><p><img loading="lazy" src="https://raw.githubusercontent.com/levanaya/web-img/main/img/20230102231349.png" alt="image-20230102231349102" class="img_ev3q"></p><p>编写配置文件如下：</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">driverClassName=com.mysql.jdbc.Driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url=jdbc:mysql:///db1?useSSL=false&amp;useServerPrepStmts=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 初始化连接数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">initialSize=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 最大连接数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">maxActive=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 最大等待时间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">maxWait=3000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用druid的代码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Druid数据库连接池演示</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DruidDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //1.导入jar包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //2.定义配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //3. 加载配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Properties prop = new Properties();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prop.load(new FileInputStream(&quot;jdbc-demo/src/druid.properties&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //4. 获取连接池对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //5. 获取数据库连接 Connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Connection connection = dataSource.getConnection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(connection); //获取到了连接后就可以继续做其他操作了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //System.out.println(System.getProperty(&quot;user.dir&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>levana</b> <!-- -->于 <b><time datetime="2023-02-23T12:44:53.000Z">2023年2月23日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/levana/dev/Java/JavaSE 基础"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">JavaSE 基础</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/levana/dev/Java/Maven&amp;MyBatis"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Maven&amp;MyBatis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-jdbc概述" class="table-of-contents__link toc-highlight">1. JDBC概述</a><ul><li><a href="#11--jdbc概念" class="table-of-contents__link toc-highlight">1.1  JDBC概念</a></li><li><a href="#12--jdbc本质" class="table-of-contents__link toc-highlight">1.2  JDBC本质</a></li><li><a href="#13--jdbc好处" class="table-of-contents__link toc-highlight">1.3  JDBC好处</a></li></ul></li><li><a href="#2-jdbc快速入门" class="table-of-contents__link toc-highlight">2. JDBC快速入门</a><ul><li><a href="#21--编写代码步骤" class="table-of-contents__link toc-highlight">2.1  编写代码步骤</a></li><li><a href="#22--具体操作" class="table-of-contents__link toc-highlight">2.2  具体操作</a></li></ul></li><li><a href="#3jdbc-api详解" class="table-of-contents__link toc-highlight">3，JDBC API详解</a><ul><li><a href="#31--drivermanager" class="table-of-contents__link toc-highlight">3.1  DriverManager</a></li><li><a href="#32--connection" class="table-of-contents__link toc-highlight">3.2  Connection</a></li><li><a href="#33--statement" class="table-of-contents__link toc-highlight">3.3  Statement</a></li><li><a href="#34--resultset" class="table-of-contents__link toc-highlight">3.4  ResultSet</a></li><li><a href="#35--案例" class="table-of-contents__link toc-highlight">3.5  案例</a></li><li><a href="#36--preparedstatement" class="table-of-contents__link toc-highlight">3.6  PreparedStatement</a></li></ul></li><li><a href="#4数据库连接池" class="table-of-contents__link toc-highlight">4，数据库连接池</a><ul><li><a href="#41--数据库连接池简介" class="table-of-contents__link toc-highlight">4.1  数据库连接池简介</a></li><li><a href="#42--数据库连接池实现" class="table-of-contents__link toc-highlight">4.2  数据库连接池实现</a></li><li><a href="#43--driud使用" class="table-of-contents__link toc-highlight">4.3  Driud使用</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with <a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer">Docusaurus</a>.</div></div></div></footer></div>
<script src="/levana/assets/js/runtime~main.2185223f.js"></script>
<script src="/levana/assets/js/main.6594e99b.js"></script>
</body>
</html>